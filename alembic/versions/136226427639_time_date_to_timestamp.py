"""time_date to timestamp

Revision ID: 136226427639
Revises: bff259039cf
Create Date: 2015-08-14 20:52:09.864468

"""

# revision identifiers, used by Alembic.
revision = '136226427639'
down_revision = 'bff259039cf'
branch_labels = None
depends_on = None

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import mysql

def upgrade(engine_name):
    globals()["upgrade_%s" % engine_name]()


def downgrade(engine_name):
    globals()["downgrade_%s" % engine_name]()





def upgrade_paperdata():
    ### commands auto generated by Alembic - please adjust! ###
    #op.drop_table('paperdata')
    op.create_foreign_key(None, 'file', 'observation', ['obsnum'], ['obsnum'])
    op.create_foreign_key(None, 'log', 'feed', ['feed_path'], ['full_path'])
    op.create_foreign_key(None, 'log', 'observation', ['obsnum'], ['obsnum'])
    op.create_foreign_key(None, 'log', 'file', ['full_path'], ['full_path'])
    ### end Alembic commands ###


def downgrade_paperdata():
    ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'log', type_='foreignkey')
    op.drop_constraint(None, 'log', type_='foreignkey')
    op.drop_constraint(None, 'log', type_='foreignkey')
    op.drop_constraint(None, 'file', type_='foreignkey')
    #op.create_table('paperdata',
    #sa.Column('path', mysql.VARCHAR(length=100), nullable=True),
    #sa.Column('era', mysql.INTEGER(display_width=11), server_default=sa.text(u"'0'"), autoincrement=False, nullable=True),
    #sa.Column('era_type', mysql.VARCHAR(length=100), nullable=True),
    #sa.Column('obsnum', mysql.BIGINT(display_width=20), server_default=sa.text(u"'0'"), autoincrement=False, nullable=True),
    #sa.Column('md5sum', mysql.VARCHAR(length=32), nullable=True),
    #sa.Column('julian_day', mysql.INTEGER(display_width=11), server_default=sa.text(u"'0'"), autoincrement=False, nullable=True),
    #sa.Column('julian_date', mysql.DECIMAL(precision=12, scale=5), server_default=sa.text(u"'0.00000'"), nullable=True),
    #sa.Column('polarization', mysql.VARCHAR(length=4), nullable=True),
    #sa.Column('data_length', mysql.DECIMAL(precision=6, scale=5), server_default=sa.text(u"'0.00000'"), nullable=True),
    #sa.Column('raw_path', mysql.VARCHAR(length=100), nullable=True),
    #sa.Column('cal_path', mysql.VARCHAR(length=100), nullable=True),
    #sa.Column('npz_path', mysql.VARCHAR(length=100), nullable=True),
    #sa.Column('final_product_path', mysql.VARCHAR(length=100), nullable=True),
    #sa.Column('tape_index', mysql.VARCHAR(length=100), nullable=True),
    #sa.Column('compr_file_size_MB', mysql.DECIMAL(precision=6, scale=1), server_default=sa.text(u"'0.0'"), nullable=True),
    #sa.Column('raw_file_size_MB', mysql.DECIMAL(precision=10, scale=1), server_default=sa.text(u"'0.0'"), nullable=True),
    #sa.Column('compressed', mysql.TINYINT(display_width=1), server_default=sa.text(u"'0'"), autoincrement=False, nullable=True),
    #sa.Column('edge', mysql.TINYINT(display_width=1), server_default=sa.text(u"'0'"), autoincrement=False, nullable=True),
    #sa.Column('write_to_tape', mysql.TINYINT(display_width=1), autoincrement=False, nullable=True),
    #sa.Column('delete_file', mysql.TINYINT(display_width=1), server_default=sa.text(u"'0'"), autoincrement=False, nullable=True),
    #sa.Column('restore_history', mysql.VARCHAR(length=255), nullable=True),
    #sa.Column('comments', mysql.TEXT(), nullable=True),
    #sa.Column('compr_md5sum', mysql.VARCHAR(length=32), server_default=sa.text(u"'NULL'"), nullable=True),
    #sa.Column('npz_md5sum', mysql.VARCHAR(length=32), server_default=sa.text(u"'NULL'"), nullable=True),
    #sa.Column('npz_file_size_MB', mysql.DECIMAL(precision=5, scale=1), server_default=sa.text(u"'0.0'"), nullable=True),
    #mysql_default_charset=u'latin1',
    #mysql_engine=u'MyISAM'
    #)
    ### end Alembic commands ###


def upgrade_ganglia():
    ### commands auto generated by Alembic - please adjust! ###
    op.add_column('cpu', sa.Column('timestamp', sa.BigInteger(), nullable=True))
    op.drop_column('cpu', 'time_date')
    op.add_column('filesystem', sa.Column('timestamp', sa.BigInteger(), nullable=True))
    op.drop_column('filesystem', 'time_date')
    op.add_column('iostat', sa.Column('timestamp', sa.BigInteger(), nullable=True))
    op.drop_column('iostat', 'time_date')
    op.add_column('monitor', sa.Column('timestamp', sa.BigInteger(), nullable=True))
    op.drop_column('monitor', 'time_date')
    op.add_column('ram', sa.Column('timestamp', sa.BigInteger(), nullable=True))
    op.drop_column('ram', 'time_date')
    ### end Alembic commands ###


def downgrade_ganglia():
    ### commands auto generated by Alembic - please adjust! ###
    op.add_column('ram', sa.Column('time_date', mysql.DECIMAL(precision=13, scale=6), server_default=sa.text(u"'0.000000'"), nullable=False))
    op.drop_column('ram', 'timestamp')
    op.add_column('monitor', sa.Column('time_date', mysql.DECIMAL(precision=13, scale=6), nullable=True))
    op.drop_column('monitor', 'timestamp')
    op.add_column('iostat', sa.Column('time_date', mysql.DECIMAL(precision=13, scale=6), server_default=sa.text(u"'0.000000'"), nullable=False))
    op.drop_column('iostat', 'timestamp')
    op.add_column('filesystem', sa.Column('time_date', mysql.BIGINT(display_width=20), nullable=False))
    op.drop_column('filesystem', 'timestamp')
    op.add_column('cpu', sa.Column('time_date', mysql.DECIMAL(precision=13, scale=6), server_default=sa.text(u"'0.000000'"), nullable=False))
    op.drop_column('cpu', 'timestamp')
    ### end Alembic commands ###

